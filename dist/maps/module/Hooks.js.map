{"version":3,"sources":["module/Hooks.ts"],"names":[],"mappings":"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","file":"../../module/Hooks.js","sourcesContent":["// import * as Module from \"module\";\n// import { DND5E } from \"../../../systems/dnd5e/module/config.js\";\n//@ts-ignore\nimport ItemSheet5e from '../../../systems/dnd5e/module/item/sheet.js';\nimport { error, log, warn } from '../main.js';\nimport ContainerConfigApplication from './container-config.js';\nimport { CanvasPrototypeOnDropHandler, canvasReadyHook } from './hooks/canvas-ready-hook.js';\nimport { createActorHook } from './hooks/create-actor-hook.js';\nimport { createItemHook } from './hooks/create-item-hook.js';\nimport { deleteItemHook } from './hooks/delete-item-hook.js';\nimport { deleteTokenHook } from './hooks/delete-token-hook.js';\nimport { lootTokenCreatedHook } from './hooks/loot-token-created-hook.js';\nimport { preCreateItemHook } from './hooks/pre-create-item-hook.js';\nimport { preUpdateItemHook } from './hooks/pre-update-item-hook.js';\nimport { preUpdateTokenHook } from './hooks/pre-update-token-hook.js';\nimport { renderItemDirectoryHook } from './hooks/render-item-directory-hook.js';\nimport { onRenderLootHud } from './hooks/render-loot-hud-hook.js';\nimport { updateItemHook } from './hooks/update-item-hook.js';\nimport { LootHud } from './loot-hud-application.js';\nimport { ItemFlags, TokenFlags } from './loot-token.js';\nimport {\n  addItemToContainer,\n  createItem,\n  createLootToken,\n  createOwnedItem,\n  createToken,\n  deleteItem,\n  deleteOwnedItem,\n  deleteToken,\n  dropItemOnToken,\n  getLootToken,\n  lootCurrency,\n  lootItem,\n  updateActor,\n  updateItem,\n  updateOwnedItem,\n  updateToken,\n} from './mainEntry.js';\nimport { ItemType, PickUpStixHooks, SocketMessage, SocketMessageType } from './models.js';\nimport { preloadTemplates } from './preloadTemplates.js';\nimport {\n  getCanvas,\n  getGame,\n  PICK_UP_STIX_FLAG,\n  PICK_UP_STIX_MODULE_NAME,\n  PICK_UP_STIX_SOCKET,\n  registerSettings,\n  SettingKeys,\n} from './settings.js';\nimport { amIFirstGm, canSeeLootToken, versionDiff } from './utils.js';\n\nexport let readyHooks = async () => {\n  log(' ready once hook');\n\n  if (getGame().system.id === 'dnd5e') {\n    Hooks.on('renderItemSheet5e', (app, protoHtml, data) => {\n      log(` renderItemSheet5e`);\n      log([app, protoHtml, data]);\n\n      const item: Item = app.object;\n\n      // can't edit the size of owned items\n      if (item.actor) return;\n\n      let html = protoHtml;\n\n      if (html[0].localName !== 'div') {\n        html = $(html[0].parentElement.parentElement);\n      }\n      const flagValue = (<any>item.getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_FLAG))?.tokenData;\n      const widthValue = flagValue?.width ?? 1; // ${item.data.flags?.['pick-up-stix']?.['pick-up-stix']?.tokenData?.width ?? 1}\n      const heightValue = flagValue?.height ?? 1; // ${item.data.flags?.['pick-up-stix']?.['pick-up-stix']?.tokenData?.height ?? 1}\n      const content = `\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label>Width</label>\n\t\t\t\t<input type=\"text\" name=\"flags.pick-up-stix.pick-up-stix.tokenData.width\" value=\"${widthValue}\" data-dtype=\"Number\">\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label>Height</label>\n\t\t\t\t<input type=\"text\" name=\"flags.pick-up-stix.pick-up-stix.tokenData.height\" value=\"${heightValue}\" data-dtype=\"Number\">\n\t\t\t</div>\n\t\t\t`;\n      $(html).find('div.item-properties div.form-group').last().after(content);\n    });\n\n    //@ts-ignore\n    // Items.registerSheet(getGame().system.id, ItemSheet5e, {makeDefault: false, types:[ItemType.CONTAINER]});\n  }\n\n  // RMEOVED ON VERSION 2.0.0 (FoundryVTT 0.8.8)\n  // if (getGame().user?.isGM) {\n  // \t//@ts-ignore\n  // \tgetGame().modules?.get(PICK_UP_STIX_MODULE_NAME).apis = {};\n  // \t//@ts-ignore\n  // \tgetGame().modules?.get(PICK_UP_STIX_MODULE_NAME).apis.v = 1;\n  // \t//@ts-ignore\n  // \tgetGame().modules?.get(PICK_UP_STIX_MODULE_NAME).apis.makeContainer = makeContainerApi;\n  // }\n\n  // this adds the 'container' type to the game system's entity types.\n  getGame().system.entityTypes.Item.push(ItemType.CONTAINER);\n\n  // add the default sheet to the container Item type\n  CONFIG.Item.sheetClasses[ItemType.CONTAINER] = {\n    'pick-up-stix.ContainerConfigApplication': {\n      label: 'pick-up-stix.ContainerConfigApplication',\n      cls: ContainerConfigApplication,\n      default: true,\n      id: 'pick-up-stix.ContainerConfigApplication',\n    },\n  };\n\n  // CONFIG.Item.typeLabels[ItemType.CONTAINER] = \"ITEM.TypeContainer\";\n\n  if (amIFirstGm()) {\n    await createDefaultFolders();\n  }\n  let scenes = getGame().scenes || [];\n  for (let el of scenes) {\n    // Scene.collection\n    let scene = el as unknown as Scene;\n    let tokens = scene.getEmbeddedCollection('Token');\n    for (let token of tokens) {\n      //const tokenFlags: TokenFlags = getProperty(token, 'flags.pick-up-stix.pick-up-stix');\n      const tokenFlags: TokenFlags = token.getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_FLAG);\n      if (!tokenFlags) {\n        continue;\n      }\n\n      let lootToken = getLootToken({ itemId: tokenFlags?.itemId, tokenId: <string>token.id })?.[0];\n\n      if (tokenFlags?.itemId && !lootToken) {\n        log(` readyHook | Creating new LootToken for Token '${token.id}' and Item '${tokenFlags.itemId}'`);\n        lootToken = await createLootToken(<string>token.id, tokenFlags.itemId, false);\n      }\n    }\n\n    scene = <Scene>getGame().scenes?.active;\n    tokens = scene.getEmbeddedCollection('Token');\n    for (let token of tokens) {\n      const tokenFlags: TokenFlags = getProperty(token, 'flags.pick-up-stix.pick-up-stix');\n      if (!tokenFlags) {\n        continue;\n      }\n\n      let lootTokens = getLootToken({ itemId: tokenFlags?.itemId, tokenId: <string>token.id });\n      for (let lt of lootTokens) {\n        if (tokenFlags.isLocked) {\n          lt.drawLock();\n        }\n        lt.activateListeners();\n      }\n    }\n  }\n  const items = <IterableIterator<Item>>getGame().items?.values();\n  for (let item of items) {\n    //if (getProperty(item, 'data.flags.pick-up-stix.pick-up-stix.itemType') === ItemType.CONTAINER) {\n    if ((<ItemFlags>item.getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_FLAG))?.itemType === ItemType.CONTAINER) {\n      item.data.type = ItemType.CONTAINER;\n    }\n  }\n  /*\n\tconst activeVersion = <string>getGame().modules?.get(PICK_UP_STIX_MODULE_NAME)?.data.version;\n\tconst previousVersion = <string>getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.version);\n\n\tif (amIFirstGm() && activeVersion !== previousVersion) {\n\t\tawait getGame().settings.set('pick-up-stix', SettingKeys.version, activeVersion);\n\t}\n\n\tconst diff = versionDiff(activeVersion, previousVersion);\n\tif (diff < 0) {\n\t\tlog(` readyHook | current version ${activeVersion} is lower than previous version ${previousVersion}`);\n\t}\n\telse if (diff > 0) {\n\t\tlog(` readyHook | current version ${activeVersion} is greater than previous version ${previousVersion}`);\n\t}\n\telse {\n\t\tlog(` readyHook | current version ${activeVersion} the same as the previous version ${previousVersion}`);\n\t}\n\t\n\tconst el = document.createElement('div');\n\tel.innerHTML = `<p>I have made some improvements that should hopefully speed up the module but want to point out a few changes</p>\n\t<p>First off you'll notice new Item folders have been created. A parent folder named <strong>Pick-Up-Stix</strong>\n\tand two folders within there named <strong>Items</strong>, and <strong>Tokens</strong>. Once these folders have been created, you\n\tare free to move them around however, if you delete them as of now there is no way to recover any previous contents,\n\tthough the folder should be recreated on the next startup. These folders can not be seen by players that are not GMs.</p>\n\t<p>The <strong>Tokens</strong> folder contains Items that represent any loot token instances that are in a scene. If you edit one of them\n\tfrom the Items directory, then you will edit all loot token instances attached to it. If you want to create another instance,\n\tsimply drag one of the Items from the <strong>Tokens</strong> Item folder and you'll have a copy of that Item that will\n\tupdate when it updates. If you delete an Item from the <strong>Tokens</strong> folder, then all loot token instances will\n\tbe removed from all scenes. If you delete all loot token instances from all scenes, the Item associated with it in the\n\t<strong>Tokens</strong> folder will also be deleted</p>\n\t<p>The <strong>Items</strong> folder is a template folder. When you create an Item and choose the 'container' type, you'll get\n\tan Item created in the <strong>Items</strong> folder. If you drag one of these onto the canvas, you'll create a new loot token\n\tbased on the properties of that Item, but you'll notice that a new Item is created in the <strong>Tokens</strong> folder. You can\n\tupdated this new loot token by either updating it's new corresponding Item or through the token's config menu. You can\n\talso update that token and then drag a copy of it from the <strong>Tokens</strong> folder NOT the <strong>Items</strong> folder to\n\tcreate a new loot token with the udpated properties. Items in the <strong>Items</strong> folder are not deleted when any\n\tloot tokens created from them are deleted, nor are any loot tokens deleted when any Items in the <strong>Items</strong> directory\n\tare removed. Currently, only container-type Items are treated as templates since item-type Items are already their own templates.</p>`;\n\n\tif (amIFirstGm() && !getGame().settings.get('pick-up-stix', SettingKeys.version13updatemessage)) {\n\tnew Dialog({\n\ttitle: 'Pick-Up-Stix - Update notification',\n\tbuttons: {\n\t\t'OK': {\n\t\tlabel: 'OK'\n\t\t}\n\t},\n\tdefault: 'OK',\n\tcontent: el.innerHTML\n\t}, {\n\t\twidth: 750,\n\theight: 'auto'\n\t}).render(true);\n\tawait getGame().settings.set(PICK_UP_STIX_MODULE_NAME, SettingKeys.version13updatemessage, true);\n\t}\n\t*/\n  getGame().socket?.on(PICK_UP_STIX_SOCKET, handleSocketMessage);\n\n  Hooks.once('canvasReady', () => {\n    //@ts-ignore\n    getCanvas().hud.pickUpStixLootHud = new LootHud();\n  });\n  Hooks.on('canvasReady', canvasReadyHook);\n  //Hooks.on('ready', readyHook);\n\n  // item hooks\n  Hooks.on('preCreateItem', preCreateItemHook);\n  Hooks.on('createItem', createItemHook);\n  Hooks.on('preUpdateItem', preUpdateItemHook);\n  Hooks.on('updateItem', updateItemHook);\n  Hooks.on('deleteItem', deleteItemHook);\n\n  // directory hooks\n  Hooks.on('renderItemDirectory', renderItemDirectoryHook);\n\n  // actor hooks\n  Hooks.on('createActor', createActorHook);\n\n  // token hooks\n  Hooks.on('deleteToken', deleteTokenHook);\n  Hooks.on('preUpdateToken', preUpdateTokenHook);\n\n  // render hooks\n  // Hooks.on(\"renderSettingsConfig\", (app, html, user) => {\n  // \tprocessHtml(html);\n  // });\n  Hooks.on('renderLootHud', onRenderLootHud);\n\n  Hooks.on(PickUpStixHooks.lootTokenCreated, lootTokenCreatedHook);\n};\n\nexport const setupHooks = async () => {\n  // setup all the hooks\n  // game startup hooks\n};\n\nexport const initHooks = async () => {\n  warn('Init Hooks processing');\n  log('initHook');\n\n  //Hooks.once('init', initHook);\n\n  // CONFIG.debug.hooks = true;\n  // CONFIG.debug['pickUpStix'] = true;\n\n  // Assign custom classes and constants here\n\n  // Register custom module settings\n  registerSettings();\n\n  // Preload Handlebars templates\n  await preloadTemplates();\n\n  // Token.prototype.release = Token_tokenRelease(Token.prototype.release);\n\n  //@ts-ignore\n  libWrapper.register(PICK_UP_STIX_MODULE_NAME, 'Token.prototype.release', TokenPrototypeReleaseHandler, 'MIXED');\n  //@ts-ignore\n  libWrapper.register(PICK_UP_STIX_MODULE_NAME, 'Token.prototype.isVisible', TokenPrototypeIsVisibleHandler, 'MIXED');\n\n  // if (getGame().system.id === 'dnd5e') {\n  // \tinfo(`pick-up-stix | initHook | System is '${getGame().system.id}' enabling Token.isVisible override.`);\n\n  // \tObject.defineProperty(Token.prototype, 'isVisible', {\n  // \t\tget: Token_isVisible,\n  // \t\tenumerable: true,\n  // \t\tconfigurable: true\n  // \t});\n  // }\n\n  // ADDED\n  //@ts-ignore\n  libWrapper.register(PICK_UP_STIX_MODULE_NAME, 'Canvas.prototype._onDrop', CanvasPrototypeOnDropHandler, 'MIXED');\n};\n\nexport const TokenPrototypeReleaseHandler = function (wrapped, ...args) {\n  const [options] = args;\n  log(` tokenRelease | called with args`);\n  log(options);\n  //origFn.call(this, options);\n  //@ts-ignore\n  if (getCanvas().hud.pickUpStixLootHud?.object === this) {\n    //@ts-ignore\n    getCanvas().hud.pickUpStixLootHud.clear();\n  }\n  return wrapped(...args);\n};\n\nexport const TokenPrototypeIsVisibleHandler = function (wrapped, ...args) {\n  log(` Token_isVisible | called with args`);\n  warn(` Token_isVisible | This method overrides isVisible of Token`);\n  let actualIsVisible: boolean;\n  if (this.data.hidden) {\n    const tokenFlags: TokenFlags = this.getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_FLAG);\n    actualIsVisible = getGame().user?.isGM || (tokenFlags && canSeeLootToken(this));\n  } else if (!getCanvas().sight?.tokenVision) {\n    actualIsVisible = true;\n  } else if (this._controlled) {\n    actualIsVisible = true;\n  } else {\n    const tolerance = Math.min(this.w, this.h) / 4;\n    actualIsVisible = <boolean>getCanvas().sight?.testVisibility(this.center, { tolerance });\n  }\n  return wrapped(...args);\n};\n\nconst createDefaultFolders = async () => {\n  log(` createDefaultFolders`);\n\n  // check if the parent folder exists and create it if not\n  let parentFolderId = <string>getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.parentItemFolderId);\n  let folder = <Folder>getGame().folders?.get(parentFolderId);\n  //let folder = Folder.collection.get(parentFolderId);\n\n  if (!folder) {\n    log(` createDefaultFolders | couldn't parent folder creating it now`);\n    folder = <Folder>await Folder.create({\n      color: '',\n      name: 'Pick-Up-Stix',\n      sorting: 'a',\n      parent: null,\n      type: 'Item',\n    });\n    parentFolderId = <string>folder.id;\n    await getGame().settings.set(PICK_UP_STIX_MODULE_NAME, SettingKeys.parentItemFolderId, parentFolderId);\n  } else {\n    log(` createDefaultFolders | parent folder '${folder.name}' found`);\n  }\n\n  // check if the tokens folder exist and create it if not\n  folder = <Folder>(\n    getGame().folders?.get(<string>getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.tokenFolderId))\n  );\n  //folder = Folder.collection.get(getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.tokenFolderId));\n\n  if (!folder) {\n    log(` createDefaultFolders | couldn't find tokens folder, creating it now`);\n    folder = <Folder>await Folder.create({\n      color: '',\n      name: 'Tokens',\n      sorting: 'a',\n      parent: <string>parentFolderId,\n      type: 'Item',\n    });\n    await getGame().settings.set(PICK_UP_STIX_MODULE_NAME, SettingKeys.tokenFolderId, folder.id);\n  } else {\n    log(` createDefaultFolders | tokens folder '${folder.name}' found`);\n  }\n\n  // check if the items folder exists and create it if not\n  folder = <Folder>(\n    getGame().folders?.get(<string>getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.itemFolderId))\n  );\n  //folder = Folder.collection.get(getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.itemFolderId));\n\n  if (!folder) {\n    log(` createDefaultFolders | couldn't find items folder`);\n    folder = <Folder>await Folder.create({\n      color: '',\n      name: 'Items',\n      sorting: 'a',\n      parent: <string>parentFolderId,\n      type: 'Item',\n    });\n    await getGame().settings.set(PICK_UP_STIX_MODULE_NAME, SettingKeys.itemFolderId, folder.id);\n  } else {\n    log(` createDefaultFolders | items folder '${folder.name}' found`);\n  }\n};\n\nexport const handleSocketMessage = async (msg: SocketMessage) => {\n  log(` handleSocketMessage | received socket message with args:`);\n  log([msg]);\n\n  if (handleNonGMMessage(msg)) {\n    return;\n  }\n\n  /* if (msg.sender === getGame().user.id) {\n\t\tlog(` handleSocketMessage | i sent this, ignoring`);\n\t\treturn;\n\t} */\n\n  if (!amIFirstGm()) {\n    return;\n  }\n\n  switch (msg.type) {\n    case SocketMessageType.deleteOwnedItem:\n      await deleteOwnedItem(msg.data.actorId, msg.data.itemId);\n      break;\n    case SocketMessageType.updateOwnedItem:\n      await updateOwnedItem(msg.data.actorId, msg.data.data);\n      break;\n    case SocketMessageType.updateActor:\n      await updateActor(<Actor>getGame().actors?.get(msg.data.actorId), msg.data.updates);\n      break;\n    case SocketMessageType.deleteToken:\n      await deleteToken(msg.data.tokenId, msg.data.sceneId);\n      break;\n    case SocketMessageType.updateItem:\n      await updateItem(msg.data.id, msg.data.updates);\n      break;\n    case SocketMessageType.updateToken:\n      await updateToken(msg.data.sceneId, msg.data.updates);\n      break;\n    case SocketMessageType.createOwnedItem:\n      await createOwnedItem(msg.data.actorId, msg.data.items);\n      break;\n    case SocketMessageType.createToken:\n      await createToken(msg.data);\n      break;\n    case SocketMessageType.createItem:\n      await createItem(msg.data.data, msg.data.options);\n      break;\n    case SocketMessageType.deleteItem:\n      await deleteItem(msg.data.id);\n      break;\n    case SocketMessageType.collectItem:\n      await lootItem(msg.data);\n      break;\n    case SocketMessageType.lootCurrency:\n      await lootCurrency(msg.data);\n      break;\n    case SocketMessageType.addItemToContainer:\n      await addItemToContainer(msg.data);\n      break;\n    case SocketMessageType.dropItemOnToken:\n      await dropItemOnToken(msg.data);\n      break;\n    default:\n      error(` handleSocketMessage | No valid socket message handler for '${msg.type}' with arg:`);\n      log([msg]);\n  }\n};\n\nconst handleNonGMMessage = (msg: SocketMessage): boolean => {\n  let handled = false;\n\n  switch (msg.type) {\n    case SocketMessageType.lootTokenCreated:\n      Hooks.callAll(PickUpStixHooks.lootTokenCreated, msg.data.tokenId);\n      handled = true;\n      break;\n    case SocketMessageType.itemCollected:\n      Hooks.callAll(PickUpStixHooks.itemCollected, msg.data);\n      handled = true;\n      break;\n    case SocketMessageType.currencyLooted:\n      Hooks.callAll(PickUpStixHooks.currencyLooted, msg.data);\n      handled = true;\n      break;\n    case SocketMessageType.itemAddedToContainer:\n      Hooks.callAll(PickUpStixHooks.itemAddedToContainer, msg.data);\n      handled = true;\n      break;\n  }\n\n  return handled;\n};\n"]}