{"version":3,"sources":["module/container-config.ts"],"names":[],"mappings":"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","file":"../../module/container-config.js","sourcesContent":["import { log } from '../main';\nimport ContainerImageSelectionApplication from './container-image-selection-application.js';\nimport { ContainerSoundConfig } from './container-sound-config-application';\nimport { ContainerLoot, ItemData, ItemFlags, TokenFlags } from './loot-token';\nimport {\n  addItemToContainer,\n  deleteOwnedItem,\n  getLootToken,\n  getValidControlledTokens,\n  lootCurrency,\n  lootItem,\n  normalizeDropData,\n  updateItem,\n} from './mainEntry';\nimport { DropData } from './models';\nimport { getCanvas, getGame, PICK_UP_STIX_FLAG, PICK_UP_STIX_MODULE_NAME, SettingKeys } from './settings';\nimport { getCurrencyTypes, getPriceDataPath, getQuantityDataPath, onChangeInputDelta } from './utils';\n\n/**\n * Application class to display to select an item that the token is\n * associated with\n */\nexport default class ContainerConfigApplication extends FormApplication {\n  private _html: any;\n  private _sourceTokenId: string;\n  private _selectedTokenId: string;\n  private _stopperElement = $(`<div class=\"stopper\">\n\t\t<div class=\"loader\"></div>\n\t</div>`);\n\n  static get defaultOptions(): any {\n    return mergeObject(super.defaultOptions, {\n      closeOnSubmit: false,\n      submitOnClose: false,\n      submitOnChange: true,\n      id: 'pick-up-stix-item-config',\n      template: `/modules/${PICK_UP_STIX_MODULE_NAME}/templates/container-config.html`,\n      width: 900,\n      title: `${getGame().user?.isGM ? 'Configure Loot Container' : 'Loot Container'}`,\n      resizable: true,\n      classes: ['pick-up-stix', 'container-config-sheet'],\n      dragDrop: [{ dropSelector: null }],\n    });\n  }\n\n  /**\n   * @override\n   */\n  get isEditable(): boolean {\n    return true;\n  }\n\n  private get currencyEnabled(): boolean {\n    return !getGame().settings.get(PICK_UP_STIX_MODULE_NAME, SettingKeys.disableCurrencyLoot);\n  }\n\n  get itemFlags(): ItemFlags {\n    return <ItemFlags>(<Item>this.object).getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_FLAG);\n  }\n\n  get tokenDatas(): any[] {\n    const tokens = getLootToken({ itemId: <string>(<Item>this.object).id }).map((lt) => lt.tokenData);\n    return tokens;\n  }\n\n  get isToken(): boolean {\n    return !!this.tokenDatas.length;\n  }\n\n  constructor(object: Item, ...args: any) {\n    super(object, args);\n\n    log(` ContainerConfigApplication ${this.appId} | constructor called with:`);\n    log([object]);\n  }\n\n  activateListeners(html) {\n    log(` ContainerConfigApplication ${this.appId}  | activateListeners`);\n    log([html]);\n    this._html = html;\n    super.activateListeners(this._html);\n\n    Hooks.off('updateToken', this.updateTokenHook);\n    Hooks.off('controlToken', this.controlTokenHook);\n\n    Hooks.on('updateToken', this.updateTokenHook);\n    Hooks.on('controlToken', this.controlTokenHook);\n\n    $(html)\n      .find('input')\n      .on('focus', (e) => e.currentTarget.select())\n      .on('change', onChangeInputDelta.bind(this.itemFlags));\n\n    if (getGame().user?.isGM) {\n      $(html).find('.configure-sound').on('click', this._onConfigureSound).css('cursor', 'pointer');\n\n      $(html).find(`[data-edit=\"img\"]`).on('click', this._onEditImage).css('cursor', 'pointer');\n\n      // set click listeners on the buttons to delete items\n      $(html).find(`a.item-delete`).on('click', this._onDeleteItem);\n    }\n\n    $(html).find('[data-actor_select]').on('click', this._onSelectActor);\n\n    if (this.currencyEnabled) {\n      // set click listener for taking currency\n      $(html).find(`a.currency-take`).on('click', this._onTakeCurrency);\n    }\n\n    // set click listeners on the buttons to pick up individual items\n    $(html).find('.loot-all-button').on('click', this._onLootAll);\n\n    $(html).find(`a.item-take`).on('click', this._onTakeItem);\n\n    $(html).find(`input[type=\"text\"]`).prop('readonly', !getGame().user?.isGM);\n\n    $(html).find(`input[type=\"text\"]`).prop('disabled', !getGame().user?.isGM);\n\n    $(html)\n      .find('input#canCloseCheckbox')\n      .prop('checked', this.itemFlags?.container?.canClose ?? true);\n\n    if (!getGame().user?.isGM) {\n      $(html).find(`input[type=\"text\"]`).addClass('isNotGM');\n    }\n  }\n\n  /**\n   *\n   * @param options\n   */\n  getData(options?: { renderData: { tokens?: Token[]; sourceToken: string; [key: string]: any } }): any {\n    log(` ContainerConfigApplication ${this.appId} | getData:`);\n    log([options]);\n    this._sourceTokenId =\n      this._sourceTokenId !== options?.renderData?.sourceToken\n        ? options?.renderData?.sourceToken ?? this._sourceTokenId\n        : this._sourceTokenId;\n\n    const actionTokens = options?.renderData?.tokens ?? [];\n    const quantityDataPath = getQuantityDataPath();\n    const priceDataPath = getPriceDataPath();\n\n    const loot = Object.entries((this.itemFlags?.container?.loot as ContainerLoot) ?? {}).reduce(\n      (prev, [lootKey, lootItems]) => {\n        const items = lootItems?.map((i: ItemData) => {\n          if (!i.data?.quantity) {\n            //if (!i.data.hasOwnProperty('quantity')) {\n            setProperty(i.data, quantityDataPath, 0);\n          }\n\n          return {\n            ...i,\n            price: +getProperty(i.data, quantityDataPath) * +parseFloat(getProperty(i.data, priceDataPath) ?? 0),\n            qty: +getProperty(i.data, quantityDataPath),\n          };\n        });\n\n        if (items?.length > 0) {\n          prev[lootKey] = items;\n        }\n\n        return prev;\n      },\n      {},\n    );\n\n    //@ts-ignore\n    let description = this.itemFlags?.container?.description ?? this.object.data?.data?.description?.value ?? '';\n    description = description.replace(/font-size:\\s*\\d*.*;/, 'font-size: 16px;');\n\n    const currencyTypes = getCurrencyTypes();\n    const tokens = (<Token[]>getValidControlledTokens(this._sourceTokenId))\n      .concat(actionTokens)\n      .reduce((acc: Token[], next: Token) => {\n        if (!next || acc.map((t: Token) => <string>t.id).includes(next.id)) {\n          return acc;\n        }\n        acc.push(next);\n        return acc;\n      }, [])\n      .map((t) => ({ token: t, class: this._selectedTokenId === t.id ? 'active' : '' }))\n      .filter((t) => !!t.token)\n      .sort((a, b) => {\n        if (a.token.name < b.token.name) return -1;\n        if (a.token.name > b.token.name) return 1;\n        return 0;\n      });\n\n    if (!this._selectedTokenId && tokens.length) {\n      log(` ContainerConfigApplication ${this.appId} | getData | setting selected token '${tokens[0].token.id}'`);\n      this._selectedTokenId = tokens[0].token.id;\n      tokens[0].class = 'active';\n    }\n\n    const data = {\n      currencyEnabled: this.currencyEnabled,\n      currencyTypes: Object.entries(currencyTypes).map(([k, v]) => ({ short: k, long: v })),\n      currency: <number>this.itemFlags.container?.currency,\n      showTakeCurrency: Object.values(this.itemFlags.container?.currency).some((amount: number) => amount > 0),\n      lootTypes: Object.keys(loot),\n      loot,\n      showLootAll: Object.keys(loot).length > 0,\n      profileImage: this.itemFlags.container?.imageOpenPath,\n      description,\n      //@ts-ignore\n      object: this.object.data,\n      width: this.itemFlags.tokenData.width ?? 1,\n      height: this.itemFlags.tokenData.height ?? 1,\n      user: getGame().user,\n      quantityDataPath,\n      hasToken: this.isToken,\n      tokens,\n    };\n\n    log(` ContainerConfigApplication ${this.appId} | getData | data to render:`);\n    log([data]);\n    return data;\n  }\n\n  /**\n   * @override\n   * @param e\n   */\n  protected async _onDrop(e) {\n    log(` ContainerConfigApplication ${this.appId}  | _onDrop`);\n    const dropData: DropData = await normalizeDropData(JSON.parse(e.dataTransfer.getData('text/plain')) ?? {});\n\n    log(` ContainerConfigApplication ${this.appId}  | _onDrop | dropped data`);\n    log([dropData]);\n\n    this.addStopper();\n\n    addItemToContainer({\n      //@ts-ignore\n      containerItemId: this.object.id,\n      itemData: dropData.data,\n    }).then(() => {\n      this._stopperElement.remove();\n    });\n\n    if (dropData.actor) {\n      deleteOwnedItem(<string>dropData.actor.id, dropData.data._id);\n    }\n  }\n\n  /**\n   * @override\n   * @param e\n   * @param formData\n   */\n  protected async _updateObject(e, formData) {\n    log(` ContainerConfigApplication ${this.appId} | _updateObject called with args:`);\n    log([e, duplicate(formData)]);\n\n    const containerData = duplicate(this.itemFlags.container);\n\n    formData = duplicate(formData);\n\n    const token = getCanvas().tokens?.placeables.find((p) => p.id === this._sourceTokenId);\n\n    formData.img = <boolean>(<TokenFlags>token?.getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_FLAG))?.isOpen\n      ? containerData?.imageOpenPath\n      : containerData?.imageClosePath;\n\n    const tokenLoot: ContainerLoot = <ContainerLoot>containerData?.loot;\n\n    if (e.type === 'change') {\n      if ($(e.currentTarget).hasClass('currency-input')) {\n        if (!e.currentTarget.value) {\n          const nameTmp = e.currentTarget.name;\n          setProperty(formData, nameTmp, 0);\n        }\n      }\n\n      Object.entries(tokenLoot ?? {}).forEach(([lootType, v]) => {\n        if (v.length === 0) {\n          return;\n        }\n\n        setProperty(\n          formData,\n          `container.loot.${lootType}`,\n          v.map((itemData) => {\n            const data = { ...itemData };\n            setProperty(\n              data.data,\n              getQuantityDataPath(),\n              $(e.currentTarget).hasClass('quantity-input') &&\n                e.currentTarget.dataset.lootType === itemData.type &&\n                e.currentTarget.dataset.lootId === itemData._id\n                ? +(<string>$(e.currentTarget).val())\n                : +getProperty(itemData.data, getQuantityDataPath()),\n            );\n            return data;\n          }),\n        );\n      });\n    }\n\n    if (this.currencyEnabled) {\n      // when the user is a GM the currency is taken from the inputs on the form, but when the user NOT a GM, there are no inputs\n      if (!getGame().user?.isGM) {\n        if (containerData.currency) {\n          setProperty(formData, `container.currency`, { ...containerData.currency });\n        }\n      }\n    }\n\n    const expandedObject = expandObject(flattenObject(formData));\n    log(` ContainerConfigApplication ${this.appId} | _updateObject | expanded 'formData' object:`);\n    log(expandedObject);\n    //@ts-ignore\n    await updateItem(this.object.id, {\n      name: formData.name,\n      flags: {\n        'pick-up-stix': {\n          'pick-up-stix': {\n            ...expandedObject,\n          },\n        },\n      },\n    });\n  }\n\n  /**\n   * @override\n   */\n  close = async () => {\n    log(` ContainerConfigApplication ${this.appId} | close`);\n    Hooks.off('updateToken', this.updateTokenHook);\n    Hooks.off('controlToken', this.controlTokenHook);\n    return super.close();\n  };\n\n  /**\n   * @override\n   * @param token\n   * @param controlled\n   */\n  private controlTokenHook = (token, controlled): void => {\n    log(` ContainerConfigApplication ${this.appId} | controlTokenHook`);\n    log([token, controlled]);\n\n    const options: any = {};\n    if (this.isToken) {\n      options['renderData'] = {\n        tokens: getValidControlledTokens(this._sourceTokenId),\n        sourceTokenId: this._sourceTokenId,\n      };\n    }\n    setTimeout(\n      (optionsTmp) => {\n        this.render(true, optionsTmp);\n      },\n      100,\n      options,\n    );\n  };\n\n  private updateTokenHook = (scene, token, diff, options): void => {\n    log(` ContainerConfigApplication ${this.appId} | updateTokenHook`);\n\n    // clear the selected token because the token might have moved too far away to be\n    // eligible\n    this._selectedTokenId = '';\n    setTimeout(this.render.bind(this), 100, { sourceTokenId: this._sourceTokenId });\n  };\n\n  private _onSelectActor = (e): void => {\n    log(` ContainerConfigApplication ${this.appId} | onActorSelect`);\n    this._selectedTokenId = e.currentTarget.dataset.token_id;\n    const options: any = { sourceTokenId: this._sourceTokenId };\n    this.render(false, options);\n  };\n\n  private _onConfigureSound = (e): void => {\n    log(` ContainerConfigApplication ${this.appId} | onConfigureSound`);\n    new ContainerSoundConfig(this.object, {}).render(true);\n  };\n\n  protected _onDeleteItem = async (e) => {\n    log(` ContainerConfigApplication | _onDeleteItem`);\n    const itemId = e.currentTarget.dataset.id;\n\n    const loot: ContainerLoot = <ContainerLoot>duplicate(this.itemFlags.container?.loot);\n\n    Object.values(loot).forEach((lootItems) => {\n      lootItems.findSplice((l) => l._id === itemId);\n    });\n\n    await this.submit({\n      updateData: {\n        container: {\n          loot,\n        },\n      },\n    });\n  };\n\n  protected _onTakeCurrency = async (e) => {\n    log(` ContainerConfigApplication ${this.appId} | _onTakeCurrency`);\n\n    if (!this._selectedTokenId) {\n      ui.notifications?.error(`You must be controlling at least one token that is within reach of the loot.`);\n      return;\n    }\n\n    const token = <Token>getCanvas().tokens?.placeables.find((t) => t.id === this._selectedTokenId);\n\n    $(this._html).find('.data-currency-input').val(0);\n\n    this.addStopper();\n\n    lootCurrency({\n      looterTokenId: token.id,\n      containerItemId: <string>(<Token>this.object).id,\n      currencies: this.itemFlags.container?.currency,\n    }).then(() => {\n      this._stopperElement.remove();\n    });\n  };\n\n  protected _onLootAll = async (e) => {\n    log(` ContainerConfigApplication ${this.appId} | _onLootAll`);\n\n    if (!this._selectedTokenId) {\n      ui.notifications?.error(`You must be controlling at least one token that is within reach of the loot.`);\n      return;\n    }\n\n    const flags: ItemFlags = <ItemFlags>duplicate(this.itemFlags);\n    const loot: ContainerLoot = <ContainerLoot>flags.container?.loot;\n    /* const itemType = $(e.currentTarget).parents(`ol[data-itemType]`).attr('data-itemType');\n\t\tconst itemId = e.currentTarget.dataset.id; */\n    const itemData = Object.values(loot)?.reduce((acc, itemDatas) => acc.concat(itemDatas), []);\n    const token = <Token>getCanvas().tokens?.placeables.find((t) => t.id === this._selectedTokenId);\n\n    lootItem({\n      looterTokenId: token.id,\n      itemData,\n      containerItemId: <string>(<Token>this.object).id,\n      lootTokenTokenId: this._sourceTokenId,\n      takeAll: true,\n    }).then(() => {\n      this._stopperElement.remove();\n    });\n  };\n\n  protected _onTakeItem = async (e) => {\n    log(` ContainerConfigApplication ${this.appId} | _onTakeItem`);\n\n    if (!this._selectedTokenId) {\n      ui.notifications?.error(`You must be controlling at least one token that is within reach of the loot.`);\n      return;\n    }\n\n    const flags: ItemFlags = <ItemFlags>duplicate(this.itemFlags);\n    const loot: ContainerLoot = <ContainerLoot>flags.container?.loot;\n    const itemType = <string>$(e.currentTarget).parents(`ol[data-itemType]`).attr('data-itemType');\n    const itemId = e.currentTarget.dataset.id;\n    const itemData = <ItemData>loot?.[itemType]?.find((i) => i._id === itemId);\n    const token = <Token>getCanvas().tokens?.placeables.find((t) => t.id === this._selectedTokenId);\n\n    this.addStopper();\n\n    lootItem({\n      looterTokenId: token.id,\n      itemData,\n      containerItemId: <string>(<Token>this.object).id,\n      lootTokenTokenId: this._sourceTokenId,\n      takeAll: false,\n    }).then(() => {\n      this._stopperElement.remove();\n    });\n  };\n\n  protected _onEditImage = async (e) => {\n    log(` ContainerConfigApplication ${this.appId}  | _onEditImage`);\n\n    new ContainerImageSelectionApplication(<Item>this.object).render(true);\n    Hooks.once('closeContainerImageSelectionApplication', (app, html) => {\n      log(` ContainerConfigApplication ${this.appId} | _onEditImage | closeContainerImageSelectionApplication hook`);\n      log([app, html]);\n    });\n  };\n\n  private addStopper(): void {\n    $(this._html).parents('#pick-up-stix-item-config').children().first().before(this._stopperElement);\n  }\n}\n"]}