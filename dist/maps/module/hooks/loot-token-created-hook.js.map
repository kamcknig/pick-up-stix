{"version":3,"sources":["module/hooks/loot-token-created-hook.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,sBAAmB;AACjC,OAAO,EAAE,eAAe,EAAE,YAAY,EAAE,wBAAqB;AAC7D,OAAO,EAAE,SAAS,EAAE,yBAAyB,EAAE,wBAAwB,EAAE,uBAAoB;AAE7F,MAAM,CAAC,MAAM,oBAAoB,GAAG,KAAK,EAAE,OAAO,EAAE,EAAE;IACpD,GAAG,CAAC,wBAAwB,CAAC,CAAC;IAC9B,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;IAEf,MAAM,KAAK,GAAiB,SAAS,EAAE,CAAC,MAAM,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,OAAO,CAAC,CAAC;IAEzF,IAAI,KAAK,EAAE;QACT,MAAM,MAAM,GAAW,KAAK,CAAC,OAAO,CAAC,wBAAwB,EAAE,yBAAyB,CAAC,CAAC;QAC1F,IAAI,SAAS,GAAG,YAAY,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAE/D,IAAI,CAAC,SAAS,EAAE;YACd,GAAG,CAAC,4EAA4E,CAAC,CAAC;YAClF,SAAS,GAAG,MAAM,eAAe,CAAC,OAAO,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;SAC3D;QAED,SAAS,EAAE,iBAAiB,EAAE,CAAC;KAChC;AACH,CAAC,CAAC","file":"../../../module/hooks/loot-token-created-hook.js","sourcesContent":["import { log } from '../../main';\nimport { createLootToken, getLootToken } from '../mainEntry';\nimport { getCanvas, PICK_UP_STIX_ITEM_ID_FLAG, PICK_UP_STIX_MODULE_NAME } from '../settings';\n\nexport const lootTokenCreatedHook = async (tokenId) => {\n  log(` lootTokenCreatedHook:`);\n  log([tokenId]);\n\n  const token: Token = <Token>getCanvas().tokens?.placeables.find((p) => p.id === tokenId);\n\n  if (token) {\n    const itemId = <string>token.getFlag(PICK_UP_STIX_MODULE_NAME, PICK_UP_STIX_ITEM_ID_FLAG);\n    let lootToken = getLootToken({ itemId: itemId, tokenId })?.[0];\n\n    if (!lootToken) {\n      log(` lootTokenCreatedHook | No LootToken instance found for created loot token`);\n      lootToken = await createLootToken(tokenId, itemId, false);\n    }\n\n    lootToken?.activateListeners();\n  }\n};\n"]}