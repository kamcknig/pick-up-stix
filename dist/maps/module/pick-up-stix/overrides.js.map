{"version":3,"sources":["module/pick-up-stix/overrides.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,qBAAkB;AACtC,OAAO,EAAE,eAAe,EAAE,uBAAoB;AAE9C,OAAO,EAAE,SAAS,EAAE,sBAAmB;AAEvC,MAAM,UAAU,kBAAkB,CAAC,MAAgB;IAClD,OAAO,UAAS,OAAO,GAAC,EAAE;QACzB,GAAG,CAAC,gDAAgD,CAAC,CAAC;QACtD,GAAG,CAAC,OAAO,CAAC,CAAC;QACb,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACzB,YAAY;QACd,IAAI,SAAS,EAAE,CAAC,GAAG,EAAE,iBAAiB,EAAE,MAAM,KAAK,IAAI,EAAE;YACrD,YAAY;YACf,SAAS,EAAE,CAAC,GAAG,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;SAC1C;QACD,OAAO,IAAI,CAAC;IACb,CAAC,CAAA;AACF,CAAC;AAED,MAAM,UAAU,eAAe;IAC9B,GAAG,CAAC,mDAAmD,CAAC,CAAC;IACzD,IAAI,CAAC,2EAA2E,CAAC,CAAC;IAClF,IAAI,eAAwB,CAAC;IAC7B,IAAK,IAAI,CAAC,IAAI,CAAC,MAAM,EAAG;QACvB,MAAM,UAAU,GAAe,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,cAAc,CAAC,CAAC;QAE5E,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC,CAAA;KACzE;SACI,IAAI,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,WAAW,EAAE;QACxC,eAAe,GAAG,IAAI,CAAC;KACvB;SACI,IAAK,IAAI,CAAC,WAAW,EAAG;QAC5B,eAAe,GAAG,IAAI,CAAC;KACvB;SACI;QACJ,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QAC/C,eAAe,GAAG,SAAS,EAAE,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,EAAC,SAAS,EAAC,CAAC,CAAC;KAC7E;IAED,OAAO,eAAe,CAAA;AACvB,CAAC","file":"../../../module/pick-up-stix/overrides.js","sourcesContent":["import { log, warn } from \"../../log\";\nimport { canSeeLootToken } from \"../../utils\";\nimport { TokenFlags } from \"./loot-token\";\nimport { getCanvas } from \"./settings\";\n\nexport function Token_tokenRelease(origFn: Function) {\n\treturn function(options={}) {\n\t\tlog(`pick-up-stix | tokenRelease | called with args`);\n\t\tlog(options);\n\t\torigFn.call(this, options);\n    //@ts-ignore\n\t\tif (getCanvas().hud?.pickUpStixLootHud?.object === this) {\n      //@ts-ignore\n\t\t\tgetCanvas().hud.pickUpStixLootHud.clear();\n\t\t}\n\t\treturn true;\n\t}\n}\n\nexport function Token_isVisible() {\n\tlog(`pick-up-stix | Token_isVisible | called with args`);\n\twarn(`pick-up-stix | Token_isVisible | This method overrides isVisible of Token`);\n\tlet actualIsVisible: boolean;\n\tif ( this.data.hidden ) {\n\t\tconst tokenFlags: TokenFlags = this.getFlag('pick-up-stix', 'pick-up-stix');\n\n\t\tactualIsVisible = game.user.isGM || (tokenFlags && canSeeLootToken(this))\n\t}\n\telse if (!getCanvas().sight.tokenVision) {\n\t\tactualIsVisible = true;\n\t}\n\telse if ( this._controlled ) {\n\t\tactualIsVisible = true;\n\t}\n\telse {\n\t\tconst tolerance = Math.min(this.w, this.h) / 4;\n\t\tactualIsVisible = getCanvas().sight.testVisibility(this.center, {tolerance});\n\t}\n\n\treturn actualIsVisible\n}\n"]}